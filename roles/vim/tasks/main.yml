---
- name: Install vim and tools needed for plugins
  pacman:
    update_cache: yes
    state: present
    name:
      - vim
      - cmake
  when: only_user_confs is not defined or not only_user_confs

- name: vimrc
  copy:
    src: vimrc
    dest: "{{ user.home }}/.vimrc"
    owner: "{{ user.name }}"
  when: do_not_copy_vimrc is not defined or not do_not_copy_vimrc

- name: Create plugin directory
  file:
    path: "{{ user.home }}/.vim/pack/git-plugins/start"
    state: directory
    owner: "{{ user.name }}"

- name: Clone ale plugin
  git:
    repo: https://github.com/w0rp/ale.git
    dest: "{{ user.home }}/.vim/pack/git-plugins/start/ale"
    version: master

- name: Clone YouCompleteMe plugin
  git:
    repo: https://github.com/Valloric/YouCompleteMe.git
    dest: "{{ user.home }}/.vim/pack/git-plugins/start/YouCompleteMe"
    version: master

- name: Install YouCompleteMe
  command: ./install.py --clang-completer
  args:
    chdir: "{{ user.home }}/.vim/pack/git-plugins/start/YouCompleteMe"

- name: Clone vim-fugitive plugin
  git:
    repo: https://github.com/tpope/vim-fugitive.git
    dest: "{{ user.home }}/.vim/pack/git-plugins/start/vim-fugitive"
    version: master
